(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-23a07e13"],{"2b1b":function(e,t,i){"use strict";i.d(t,"c",function(){return r}),i.d(t,"b",function(){return o}),i.d(t,"d",function(){return l}),i.d(t,"a",function(){return n});var a=i("b775");function r(e){return Object(a["a"])({url:"booking/bookings/",method:"get",params:e})}function o(e){return Object(a["a"])({url:"booking/bookings/".concat(e,"/"),method:"get"})}function l(e,t){return Object(a["a"])({url:"booking/bookings/".concat(e,"/"),method:"put",data:t})}function n(e){return Object(a["a"])({url:"booking/bookings/",method:"post",data:e})}},"666f":function(e,t,i){"use strict";var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"createPost-container"},[e.postForm.can_delete||e.postForm.can_cancel||e.postForm.can_save?i("sticky",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{"z-index":10,"class-name":"sub-navbar "+e.postForm.status}},[e.postForm.can_delete?i("el-button",{staticStyle:{"margin-left":"10px"},attrs:{type:"danger"},on:{click:e.deleteFormConfirm}},[e._v("\n      Delete\n    ")]):e._e(),e._v(" "),e.postForm.can_cancel?i("el-button",{staticStyle:{"margin-left":"10px"},attrs:{type:"warning"},on:{click:e.cancelFormConfirm}},[e._v("\n      Cancel\n    ")]):e._e(),e._v(" "),e.postForm.can_save?i("el-button",{staticStyle:{"margin-left":"10px"},attrs:{type:"success"},on:{click:e.updateForm}},[e._v("\n      Save\n    ")]):e._e()],1):e.isEdit?e._e():i("sticky",{attrs:{"z-index":10,"class-name":"sub-navbar "+e.postForm.status}},[i("el-button",{staticStyle:{"margin-left":"10px"},attrs:{type:"success"},on:{click:function(t){return e.createForm(!0)}}},[e._v("\n      Create\n    ")])],1),e._v(" "),i("el-form",{ref:"postForm",staticClass:"form-container",attrs:{model:e.postForm,rules:e.rules,"label-position":"top","label-width":"120px"}},[i("div",{staticClass:"createPost-main-container"},[i("div",{staticClass:"bookingInfo-container"},[i("el-row",{attrs:{gutter:24}},[i("el-col",{attrs:{span:16}},[i("el-card",[i("el-form-item",{attrs:{label:"Start time:",prop:"start_time"}},[i("el-date-picker",{attrs:{type:"datetime",format:"yyyy-MM-dd HH:mm",placeholder:"Select date and time",clearable:"",disabled:e.isEdit},on:{change:e.handleDuration},model:{value:e.postForm.start_time,callback:function(t){e.$set(e.postForm,"start_time",t)},expression:"postForm.start_time"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"End time:",prop:"end_time"}},[i("el-date-picker",{attrs:{type:"datetime",format:"yyyy-MM-dd HH:mm",placeholder:"Select date and time",clearable:"",disabled:e.isEdit},on:{change:e.handleDuration},model:{value:e.postForm.end_time,callback:function(t){e.$set(e.postForm,"end_time",t)},expression:"postForm.end_time"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"ConfirmId:"}},[i("el-input",{staticStyle:{width:"300px"},attrs:{disabled:e.isEdit},model:{value:e.postForm.confirmId,callback:function(t){e.$set(e.postForm,"confirmId",t)},expression:"postForm.confirmId"}})],1),e._v(" "),i("el-form-item",{staticStyle:{width:"300px"},attrs:{label:"Contact name:",prop:"contact_name"}},[i("el-input",{attrs:{disabled:!e.postForm.can_save&&e.isEdit},model:{value:e.postForm.contact_name,callback:function(t){e.$set(e.postForm,"contact_name",t)},expression:"postForm.contact_name"}})],1),e._v(" "),i("el-form-item",{staticStyle:{width:"300px"},attrs:{label:"Contact phone:",prop:"contact_phone"}},[i("el-input",{attrs:{disabled:!e.postForm.can_save&&e.isEdit},model:{value:e.postForm.contact_phone,callback:function(t){e.$set(e.postForm,"contact_phone",t)},expression:"postForm.contact_phone"}})],1),e._v(" "),e.postForm.start_time&&e.postForm.end_time?i("el-form-item",{staticStyle:{width:"300px"},attrs:{label:"Vehicle:",prop:"vehicle_id"}},[e.vehicle?i("el-input",{attrs:{"suffix-icon":"el-icon-search",readonly:"",disabled:e.isEdit},on:{focus:e.handleVehicle},model:{value:e.vehicle.traffic_plate_no,callback:function(t){e.$set(e.vehicle,"traffic_plate_no",t)},expression:"vehicle.traffic_plate_no"}}):i("el-input",{attrs:{"suffix-icon":"el-icon-search",readonly:""},on:{focus:e.handleVehicle},model:{value:e.vehicle,callback:function(t){e.vehicle=t},expression:"vehicle"}})],1):e._e(),e._v(" "),e.postForm.start_time&&e.postForm.end_time?i("el-form-item",{staticStyle:{width:"300px"},attrs:{label:"Guide:",prop:"guide_id"}},[i("el-input",{attrs:{"suffix-icon":"el-icon-search",readonly:"",disabled:e.isEdit},on:{focus:e.handleGuide},model:{value:e.guide,callback:function(t){e.guide=t},expression:"guide"}})],1):e._e(),e._v(" "),i("el-form-item",{attrs:{label:"Pick up address:"}},[i("el-input",{attrs:{disabled:!e.postForm.can_save&&e.isEdit},model:{value:e.postForm.pick_up_addr,callback:function(t){e.$set(e.postForm,"pick_up_addr",t)},expression:"postForm.pick_up_addr"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"Drop off address:"}},[i("el-input",{attrs:{disabled:!e.postForm.can_save&&e.isEdit},model:{value:e.postForm.drop_off_addr,callback:function(t){e.$set(e.postForm,"drop_off_addr",t)},expression:"postForm.drop_off_addr"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"Remark:"}},[i("el-input",{attrs:{autosize:{minRows:4,maxRows:4},type:"textarea",maxlength:256,"show-word-limit":!0,disabled:!e.postForm.can_save&&e.isEdit},model:{value:e.postForm.remark,callback:function(t){e.$set(e.postForm,"remark",t)},expression:"postForm.remark"}})],1)],1)],1),e._v(" "),i("el-col",{attrs:{span:8}},[i("el-card",[i("el-form-item",{attrs:{label:"Status:"}},[e.postForm.status?i("el-input",{attrs:{disabled:""},model:{value:e.postForm.status,callback:function(t){e.$set(e.postForm,"status",t)},expression:"postForm.status"}}):i("el-input",{attrs:{disabled:""}})],1),e._v(" "),i("el-form-item",{attrs:{label:"Order:"}},[i("el-input",{attrs:{disabled:""},model:{value:e.order,callback:function(t){e.order=t},expression:"order"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"Creator:"}},[i("el-input",{attrs:{disabled:""},model:{value:e.creator,callback:function(t){e.creator=t},expression:"creator"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"Company:"}},[i("el-input",{attrs:{disabled:""},model:{value:e.company,callback:function(t){e.company=t},expression:"company"}})],1),e._v(" "),e.postForm.create_at?i("el-form-item",{attrs:{label:"Create at:"}},[i("span",[e._v(e._s(e._f("moment")(e.postForm.create_at,"YYYY-MM-DD HH:mm")))])]):e._e(),e._v(" "),e.postForm.change_at?i("el-form-item",{attrs:{label:"Change at:"}},[i("span",[e._v(e._s(e._f("moment")(e.postForm.change_at,"YYYY-MM-DD HH:mm")))])]):e._e()],1)],1)],1)],1),e._v(" "),i("div",{staticClass:"itinerary-container"},[i("el-card",[i("div",{attrs:{slot:"header"},slot:"header"},[i("el-row",{attrs:{type:"flex",justify:"space-between"}},[i("el-col",{attrs:{span:6}},[i("div",{attrs:{align:"left"}},[e._v("Itinerary")])])],1)],1),e._v(" "),e.vehicle?i("div",[i("el-table",{key:e.tableKey,staticStyle:{width:"100%"},attrs:{data:e.postForm.itinerary,border:"",stripe:"",fit:"","summary-method":e.getSummaries,"show-summary":"","highlight-current-row":"","row-key":"id"}},[i("el-table-column",{attrs:{width:"120px",label:"Day",fixed:"left",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[i("span",[e._v(e._s(a.day))])]}}],null,!1,643374488)}),e._v(" "),i("el-table-column",{attrs:{label:"Fullday",width:"80px",align:"center","class-name":"small-padding fixed-width"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[i("el-checkbox",{attrs:{disabled:""},model:{value:a.full_day,callback:function(t){e.$set(a,"full_day",t)},expression:"row.full_day"}})]}}],null,!1,898802084)}),e._v(" "),i("el-table-column",{attrs:{label:"Freedomday",width:"100px",align:"center","class-name":"small-padding fixed-width"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[i("el-checkbox",{attrs:{disabled:""},model:{value:a.freedom_day,callback:function(t){e.$set(a,"freedom_day",t)},expression:"row.freedom_day"}})]}}],null,!1,195692709)}),e._v(" "),i("el-table-column",{attrs:{width:"300px",label:"Itinerary",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[i("span",[e._v(e._s(a.itinerary))])]}}],null,!1,754639939)}),e._v(" "),i("el-table-column",{attrs:{width:"140px",label:"Vehicle Charge",prop:"vehicle_gross_charge",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[a.vehicle_gross_charge?i("span",[e._v(e._s(a.vehicle_gross_charge)+" AED")]):e._e()]}}],null,!1,743599060)}),e._v(" "),i("el-table-column",{attrs:{width:"140px",label:"Guide Charge",prop:"guide_charge",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[a.guide_charge?i("span",[e._v(e._s(a.guide_charge)+" AED")]):e._e()]}}],null,!1,240273844)}),e._v(" "),i("el-table-column",{attrs:{"min-width":"300px",label:"Remark",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[i("span",[e._v(e._s(a.remark))])]}}],null,!1,1191055846)}),e._v(" "),i("el-table-column",{attrs:{label:"Actions",align:"center",width:"100px",fixed:"right","class-name":"small-padding fixed-width"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[i("el-button",{attrs:{type:"primary",size:"mini",disabled:e.isEdit},on:{click:function(t){return e.handleItinerary(a)}}},[e._v("\n                    Edit\n                  ")])]}}],null,!1,2547023427)})],1)],1):e._e()])],1),e._v(" "),e.isEdit&&e.postForm.can_comment?i("div",{staticClass:"comment-container"},[i("el-card",[i("div",{attrs:{slot:"header"},slot:"header"},[i("span",[e._v("Comment")])]),e._v(" "),i("div",[i("el-row",[e.vehicle?i("el-col",{attrs:{span:5}},[i("el-form-item",{attrs:{label:"Vehicle Score:"}},[i("el-rate",{staticStyle:{"margin-top":"8px"},attrs:{max:5,colors:["#99A9BF","#F7BA2A","#FF9900"],"low-threshold":1,"high-threshold":5},model:{value:e.postForm.vehicle_score,callback:function(t){e.$set(e.postForm,"vehicle_score",t)},expression:"postForm.vehicle_score"}})],1)],1):e._e(),e._v(" "),e.guide?i("el-col",{attrs:{span:5}},[i("el-form-item",{attrs:{label:"Guide Score:"}},[i("el-rate",{staticStyle:{"margin-top":"8px"},attrs:{max:5,colors:["#99A9BF","#F7BA2A","#FF9900"],"low-threshold":1,"high-threshold":5},model:{value:e.postForm.guide_score,callback:function(t){e.$set(e.postForm,"guide_score",t)},expression:"postForm.guide_score"}})],1)],1):e._e()],1),e._v(" "),i("el-row",[i("el-col",[i("el-form-item",{attrs:{label:"Comment:"}},[i("el-input",{attrs:{autosize:{minRows:4,maxRows:4},type:"textarea",maxlength:256},model:{value:e.postForm.comment,callback:function(t){e.$set(e.postForm,"comment",t)},expression:"postForm.comment"}})],1)],1)],1)],1)])],1):e._e()])]),e._v(" "),i("el-dialog",{attrs:{title:"Select Vehicle",visible:e.vehicleDialog.show,width:"85%"},on:{"update:visible":function(t){return e.$set(e.vehicleDialog,"show",t)},close:e.handleVehicleClose}},[i("div",{staticClass:"filter-container"},[i("el-select",{staticClass:"filter-item",attrs:{placeholder:"Category",clearable:""},on:{change:e.loadVehicles},model:{value:e.vehicleDialog.query.model__category,callback:function(t){e.$set(e.vehicleDialog.query,"model__category",t)},expression:"vehicleDialog.query.model__category"}},e._l(e.vehicle_category,function(e){return i("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1),e._v(" "),i("el-input-number",{staticClass:"filter-item",attrs:{min:5,max:60,placeholder:"Passengers"},on:{change:e.loadVehicles},model:{value:e.vehicleDialog.query.passengers,callback:function(t){e.$set(e.vehicleDialog.query,"passengers",t)},expression:"vehicleDialog.query.passengers"}}),e._v(" "),i("el-button",{staticClass:"filter-item",attrs:{type:"primary"},on:{click:e.loadVehicles}},[e._v("Refresh")])],1),e._v(" "),i("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.vehicleDialog.vehicleLoading,expression:"vehicleDialog.vehicleLoading"}],key:e.tableKey,staticStyle:{width:"100%"},attrs:{data:e.vehicleDialog.vehicleList,border:"",stripe:"",fit:"","highlight-current-row":""}},[i("el-table-column",{attrs:{label:"Traffic Number",align:"center","min-width":"120px"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[i("span",{staticClass:"link-type",on:{click:function(t){return e.selectVechicleHandle(a)}}},[e._v(e._s(a.traffic_plate_no))])]}}])}),e._v(" "),i("el-table-column",{attrs:{label:"Brand",align:"center",width:"120px"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[i("span",{staticClass:"link-type",on:{click:function(t){return e.selectVechicleHandle(a)}}},[e._v(e._s(a.model.brand.name))])]}}])}),e._v(" "),i("el-table-column",{attrs:{label:"Model",align:"center","min-width":"120px"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[i("span",{staticClass:"link-type",on:{click:function(t){return e.selectVechicleHandle(a)}}},[e._v(e._s(a.model.name))])]}}])}),e._v(" "),i("el-table-column",{attrs:{label:"Year",align:"center",width:"120px"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[i("span",{staticClass:"link-type",on:{click:function(t){return e.selectVechicleHandle(a)}}},[e._v(e._s(a.model.year))])]}}])}),e._v(" "),i("el-table-column",{attrs:{label:"Type",align:"center",width:"120px"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[i("span",{staticClass:"link-type",on:{click:function(t){return e.selectVechicleHandle(a)}}},[e._v(e._s(a.model.type))])]}}])}),e._v(" "),i("el-table-column",{attrs:{label:"Category",align:"center","min-width":"120px"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[i("span",{staticClass:"link-type",on:{click:function(t){return e.selectVechicleHandle(a)}}},[e._v(e._s(a.model.category))])]}}])}),e._v(" "),i("el-table-column",{attrs:{label:"Passengers",align:"center",width:"120px"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[i("span",{staticClass:"link-type",on:{click:function(t){return e.selectVechicleHandle(a)}}},[e._v(e._s(a.model.passengers))])]}}])}),e._v(" "),i("el-table-column",{attrs:{label:"Average Score",width:"130px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[i("span",{staticClass:"link-type",on:{click:function(t){return e.selectVechicleHandle(a)}}},[e._v(e._s(a.avg_score))])]}}])}),e._v(" "),i("el-table-column",{attrs:{label:"Total Score",width:"130px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[i("span",{staticClass:"link-type",on:{click:function(t){return e.selectVechicleHandle(a)}}},[e._v(e._s(a.total_score))])]}}])})],1)],1),e._v(" "),i("el-dialog",{attrs:{title:"Select Guide",visible:e.guideDialog.show,width:"85%"},on:{"update:visible":function(t){return e.$set(e.guideDialog,"show",t)},close:e.handleGuideClose}},[i("div",{staticClass:"filter-container"},[i("el-button",{staticClass:"filter-item",attrs:{type:"primary"},on:{click:e.loadGuides}},[e._v("Refresh")])],1),e._v(" "),i("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.guideDialog.loading,expression:"guideDialog.loading"}],key:e.tableKey,staticStyle:{width:"100%"},attrs:{data:e.guideDialog.list,border:"",stripe:"",fit:"","highlight-current-row":""}},[i("el-table-column",{attrs:{label:"UserName",align:"center",width:"180px"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[i("span",{staticClass:"link-type",on:{click:function(t){return e.selectGuideHandle(a)}}},[e._v(e._s(a.username))])]}}])}),e._v(" "),i("el-table-column",{attrs:{label:"Name",align:"center",width:"120px"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[i("span",{staticClass:"link-type",on:{click:function(t){return e.selectGuideHandle(a)}}},[e._v(e._s(a.name))])]}}])}),e._v(" "),i("el-table-column",{attrs:{label:"Phone",width:"120px",align:"center","class-name":"small-padding fixed-width"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[i("span",{staticClass:"link-type",on:{click:function(t){return e.selectGuideHandle(a)}}},[e._v(e._s(a.phone))])]}}])}),e._v(" "),i("el-table-column",{attrs:{label:"Company",width:"200px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[a.company?i("span",{staticClass:"link-type",on:{click:function(t){return e.selectGuideHandle(a)}}},[e._v(e._s(a.company.name))]):e._e()]}}])}),e._v(" "),i("el-table-column",{attrs:{label:"Average Score",width:"130px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[i("span",{staticClass:"link-type",on:{click:function(t){return e.selectGuideHandle(a)}}},[e._v(e._s(a.avg_score))])]}}])}),e._v(" "),i("el-table-column",{attrs:{label:"Total Score",width:"130px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[i("span",{staticClass:"link-type",on:{click:function(t){return e.selectGuideHandle(a)}}},[e._v(e._s(a.total_score))])]}}])}),e._v(" "),i("el-table-column",{attrs:{label:"Introduction","min-width":"150px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[i("span",{staticClass:"link-type",on:{click:function(t){return e.selectGuideHandle(a)}}},[e._v(e._s(a.introduction))])]}}])})],1)],1),e._v(" "),i("el-dialog",{attrs:{title:"Edit Itinerary",visible:e.itineraryDialog.show,width:"800px"},on:{"update:visible":function(t){return e.$set(e.itineraryDialog,"show",t)}}},[i("el-form",{ref:"itineraryForm",staticStyle:{width:"400px","margin-left":"20px"},attrs:{model:e.itineraryDialog.data,rules:e.itineraryDialog.rules,"label-position":"left","label-width":"120px"}},[i("el-form-item",{attrs:{label:"Day",prop:"day",rules:{required:!0,message:"This fields is required",trigger:"change"}}},[i("el-date-picker",{attrs:{type:"date",format:"yyyy-MM-dd",placeholder:"Select date",clearable:"",disabled:""},model:{value:e.itineraryDialog.data.day,callback:function(t){e.$set(e.itineraryDialog.data,"day",t)},expression:"itineraryDialog.data.day"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"Freedom Day",prop:"freedom"}},[i("el-checkbox",{model:{value:e.itineraryDialog.data.freedom_day,callback:function(t){e.$set(e.itineraryDialog.data,"freedom_day",t)},expression:"itineraryDialog.data.freedom_day"}})],1),e._v(" "),e.vehicle?i("el-form-item",{attrs:{label:"Itinerary",prop:"itinerary"}},[i("el-select",{attrs:{placeholder:"Select Itinerary",disabled:e.itineraryDialog.data.freedom_day},on:{change:e.handleItineraryChange},model:{value:e.itineraryDialog.data.itinerary,callback:function(t){e.$set(e.itineraryDialog.data,"itinerary",t)},expression:"itineraryDialog.data.itinerary"}},e._l(e.vehicle.model.price,function(e){return i("el-option",{key:e.id,attrs:{label:e.itinerary,value:e.itinerary}})}),1)],1):e._e(),e._v(" "),i("el-form-item",{attrs:{label:"remark",prop:"remark"}},[i("el-input",{attrs:{autosize:{minRows:2,maxRows:4},maxlength:256,type:"textarea"},model:{value:e.itineraryDialog.data.remark,callback:function(t){e.$set(e.itineraryDialog.data,"remark",t)},expression:"itineraryDialog.data.remark"}})],1)],1),e._v(" "),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(t){e.itineraryDialog.show=!1}}},[e._v("\n        Cancel\n      ")]),e._v(" "),i("el-button",{attrs:{type:"primary"},on:{click:e.updateItineraryData}},[e._v("\n        Confirm\n      ")])],1)],1),e._v(" "),i("el-dialog",{attrs:{title:e.createDialog.title,visible:e.createDialog.show,width:"800px"},on:{"update:visible":function(t){return e.$set(e.createDialog,"show",t)}}},[i("el-form",{staticStyle:{width:"400px","margin-left":"20px"},attrs:{"label-position":"left","label-width":"120px"}},[i("el-form-item",{attrs:{label:"Start Time:",prop:"start_time"}},[i("el-date-picker",{attrs:{type:"datetime",format:"yyyy-MM-dd HH:mm",readonly:""},model:{value:e.postForm.start_time,callback:function(t){e.$set(e.postForm,"start_time",t)},expression:"postForm.start_time"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"End Time:",prop:"end_time"}},[i("el-date-picker",{attrs:{type:"datetime",format:"yyyy-MM-dd HH:mm",readonly:""},model:{value:e.postForm.end_time,callback:function(t){e.$set(e.postForm,"end_time",t)},expression:"postForm.end_time"}})],1),e._v(" "),e.vehicle?i("el-form-item",{attrs:{label:"Vehicle:",prop:"vehicle_id"}},[i("el-input",{attrs:{readonly:""},model:{value:e.vehicle.traffic_plate_no,callback:function(t){e.$set(e.vehicle,"traffic_plate_no",t)},expression:"vehicle.traffic_plate_no"}})],1):e._e(),e._v(" "),e.guide?i("el-form-item",{attrs:{label:"Guide:",prop:"guide_id"}},[i("el-input",{attrs:{readonly:""},model:{value:e.guide,callback:function(t){e.guide=t},expression:"guide"}})],1):e._e(),e._v(" "),e.vehicle?i("el-form-item",{attrs:{label:"Vehicle Charge:"}},[i("span",[e._v(e._s(e.vehicle_charge())+" AED")])]):e._e(),e._v(" "),e.guide?i("el-form-item",{attrs:{label:"Guide Charge:"}},[i("span",[e._v(e._s(e.guide_charge())+" AED")])]):e._e(),e._v(" "),i("el-form-item",{attrs:{label:"Discount:"}},[i("span",[e._v(e._s(e.discount())+" AED")])]),e._v(" "),i("el-form-item",{attrs:{label:"Total:"}},[i("span",[e._v(e._s(e.total())+" AED")])])],1),e._v(" "),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(t){e.createDialog.show=!1}}},[e._v("\n        Cancel\n      ")]),e._v(" "),i("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.createForm(!1)}}},[e._v("\n        Create\n      ")])],1)],1)],1)},r=[],o=(i("c5f6"),i("ac4d"),i("8a81"),i("ac6a"),i("a481"),i("7f7f"),function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{style:{height:e.height+"px",zIndex:e.zIndex}},[i("div",{class:e.className,style:{top:e.isSticky?e.stickyTop+"px":"",zIndex:e.zIndex,position:e.position,width:e.width,height:e.height+"px"}},[e._t("default",[i("div",[e._v("sticky")])])],2)])}),l=[],n={name:"Sticky",props:{stickyTop:{type:Number,default:0},zIndex:{type:Number,default:1},className:{type:String,default:""}},data:function(){return{active:!1,position:"",width:void 0,height:void 0,isSticky:!1}},mounted:function(){this.height=this.$el.getBoundingClientRect().height,window.addEventListener("scroll",this.handleScroll),window.addEventListener("resize",this.handleResize)},activated:function(){this.handleScroll()},destroyed:function(){window.removeEventListener("scroll",this.handleScroll),window.removeEventListener("resize",this.handleResize)},methods:{sticky:function(){this.active||(this.position="fixed",this.active=!0,this.width=this.width+"px",this.isSticky=!0)},handleReset:function(){this.active&&this.reset()},reset:function(){this.position="",this.width="auto",this.active=!1,this.isSticky=!1},handleScroll:function(){var e=this.$el.getBoundingClientRect().width;this.width=e||"auto";var t=this.$el.getBoundingClientRect().top;t<this.stickyTop?this.sticky():this.handleReset()},handleResize:function(){this.isSticky&&(this.width=this.$el.getBoundingClientRect().width+"px")}}},s=n,c=i("2877"),d=Object(c["a"])(s,o,l,!1,null,null,null),u=d.exports,h=(i("61f7"),i("2b1b")),m=i("fbb2"),p=i("c24f"),f=[{value:"Mini Car",label:"Mini Car"},{value:"Economy Car",label:"Economy Car"},{value:"Standerd Car",label:"Standerd Car"},{value:"Luxury Car",label:"Luxury Car"},{value:"SUV Car",label:"SUV Car"},{value:"7 Seat Car",label:"7 Seat Car"},{value:"Permium Car",label:"Permium Car"},{value:"Luxury Coachs Bus",label:"Luxury Coachs Bus"},{value:"Mini Coaches Bus",label:"Mini Coaches Bus"},{value:"Mini Vans Bus",label:"Mini Vans Bus"}],v={id:void 0,confirmId:void 0,bookingId:void 0,status:void 0,start_time:void 0,end_time:void 0,contact_name:void 0,contact_phone:void 0,pick_up_addr:void 0,drop_off_addr:void 0,remark:void 0,create_at:void 0,change_at:void 0,vehicle_id:void 0,guide_id:void 0,itinerary:[]},g={name:"BookingDetail",components:{Sticky:u},props:{isEdit:{type:Boolean,default:!1}},mounted:function(){},data:function(){var e=this,t=function(t,i,a){""===i||void 0===i?e.itineraryDialog.data.freedom_day?a():a(new Error("This fields is required")):a()};return{tableKey:0,postForm:Object.assign({},v),loading:!1,vehicle_category:f,rules:{start_time:[{required:!0,message:"This fields is required",trigger:"change"}],end_time:[{required:!0,message:"This fields is required",trigger:"change"}],contact_name:[{required:!0,message:"This fields is required",trigger:"change"}],contact_phone:[{required:!0,message:"This fields is required",trigger:"change"}],vehicle_id:[{required:!0,message:"This fields is required",trigger:"change"}]},tempRoute:{},relatedKey:{vehicle:void 0,guide:void 0,order:void 0,create_by:void 0,company_by:void 0},vehicleDialog:{show:!1,select:!1,query:{is_actived:!0,start_time:void 0,end_time:void 0,model__category:void 0,passengers:void 0},vehicleList:[],vehicleLoading:!1},guideDialog:{show:!1,select:!1,query:{is_actived:!0,is_tourguide:!0,start_time:void 0,end_time:void 0},list:[],loading:!1},itineraryDialog:{show:!1,data:{day:void 0,itinerary:void 0,full_day:void 0,freedom_day:void 0,vehicle_cost_charge:void 0,vehicle_gross_charge:void 0,guide_charge:void 0,remark:void 0},rules:{itinerary:[{validator:t,trigger:"change"}]}},createDialog:{show:!1,title:"Please check the information again."}}},computed:{vehicle:{get:function(){if(this.relatedKey.vehicle)return this.relatedKey.vehicle},set:function(e){this.postForm.vehicle_id=e?e.id:void 0,this.relatedKey.vehicle=e,delete this.postForm.vehicle}},guide:{get:function(){if(this.relatedKey.guide)return this.relatedKey.guide.name||this.relatedKey.guide.username},set:function(e){this.postForm.guide_id=e?e.id:void 0,this.relatedKey.guide=e,delete this.postForm.guide}},order:{get:function(){if(this.relatedKey.order)return this.relatedKey.order.orderId},set:function(e){e&&(this.relatedKey.order=e,delete this.postForm.order)}},creator:{get:function(){if(this.relatedKey.create_by)return this.relatedKey.create_by.name||this.relatedKey.create_by.username},set:function(e){e&&(this.relatedKey.create_by=e,delete this.postForm.create_by)}},company:{get:function(){if(this.relatedKey.company_by)return this.relatedKey.company_by.name},set:function(e){e&&(this.relatedKey.company_by=e,delete this.postForm.company_by)}}},created:function(){if(this.isEdit){var e=this.$route.params&&this.$route.params.id;this.fetchData(e)}else this.postForm=Object.assign({},v);this.tempRoute=Object.assign({},this.$route)},methods:{setData:function(e){this.postForm=e,this.vehicle=this.postForm.vehicle,this.guide=this.postForm.guide,this.order=this.postForm.order,this.creator=this.postForm.create_by,this.company=this.postForm.company_by,this.history=this.postForm.history,this.handleDuration()},fetchData:function(e){var t=this;Object(h["b"])(e).then(function(e){t.setData(e.data),t.setTagsViewTitle()})},setTagsViewTitle:function(){var e="Edit Booking",t=Object.assign({},this.tempRoute,{title:"".concat(e,"-").concat(this.postForm.bookingId)});this.$store.dispatch("tagsView/updateVisitedView",t)},createForm:function(e){var t=this;this.$refs.postForm.validate(function(i){if(!i||!t.valideItinerary())return!1;e?t.createDialog.show=!0:(t.createDialog.show=!1,t.loading=!0,t.postForm.status="Created",Object(h["a"])(t.postForm).then(function(e){var i=e.data["id"];t.loading=!1,t.$store.dispatch("tagsView/delView",t.$route).then(function(){t.$nextTick(function(){t.$router.replace({path:"/booking/edit/"+i})})})}).catch(function(e){t.loading=!1}))})},updateForm:function(){var e=this;this.$refs.postForm.validate(function(t){if(!t)return!1;e.loading=!0,Object(h["d"])(e.postForm.id,e.postForm).then(function(t){e.setData(t.data),e.$notify({title:"Success",message:"Change Successfully",type:"success",duration:2e3}),e.loading=!1}).catch(function(t){e.loading=!1})})},updateStatus:function(e){var t=this;this.loading=!0,this.postForm.status=e,Object(h["d"])(this.postForm.id,this.postForm).then(function(i){if(t.setData(i.data),t.$notify({title:"Success",message:e+"Successfully",type:"success",duration:2e3}),t.loading=!1,"Delete"===t.postForm.status){var a=t.$route;t.$store.dispatch("tagsView/delView",a).then(function(e){var i=e.visitedViews,a=i.slice(-1)[0];i[0];t.$router.push(a)})}}).catch(function(e){t.loading=!1})},cancelFormConfirm:function(){var e=this;this.$confirm("Are you sure to cancel the booking?","Alert",{confirmButtonText:"Confirm",cancelButtonText:"Cancel",type:"warning"}).then(function(){e.updateStatus("Cancel")})},deleteFormConfirm:function(){var e=this;this.$confirm("Are you sure to delete the booking?","Alert",{confirmButtonText:"Confirm",cancelButtonText:"Cancel",type:"warning"}).then(function(){e.updateStatus("Delete")})},handleVehicle:function(e){var t=this;this.vehicleDialog.show=!0,this.vehicleDialog.select=!1,this.loadVehicles(),this.$nextTick(function(){t.$refs["postForm"].clearValidate()})},loadVehicles:function(){var e=this;this.vehicleDialog.vehicleLoading=!0,this.vehicleDialog.vehicleList=[],this.vehicleDialog.query.start_time=this.postForm.start_time,this.vehicleDialog.query.end_time=this.postForm.end_time,Object(m["a"])(this.vehicleDialog.query).then(function(t){e.vehicleDialog.vehicleList=t.data,e.vehicleDialog.vehicleLoading=!1}).catch(function(t){e.vehicleDialog.vehicleLoading=!1})},loadGuides:function(){var e=this;this.guideDialog.loading=!0,this.guideDialog.list=[],this.guideDialog.query.start_time=this.postForm.start_time,this.guideDialog.query.end_time=this.postForm.end_time,Object(p["b"])(this.guideDialog.query).then(function(t){e.guideDialog.list=t.data,e.guideDialog.loading=!1}).catch(function(t){e.guideDialog.loading=!1})},handleGuide:function(){this.guideDialog.show=!0,this.guideDialog.select=!1,0==this.guideDialog.list.length&&this.loadGuides()},handleGuideClose:function(){this.guideDialog.select||(this.guide=null)},handleVehicleClose:function(){this.vehicleDialog.select||(this.vehicle=null)},handleItinerary:function(e){var t=this;this.itineraryDialog.show=!0,this.itineraryDialog.data=Object.assign({},e),this.$nextTick(function(){t.$refs["itineraryForm"].clearValidate()})},selectVechicleHandle:function(e){this.vehicleDialog.show=!1,this.vehicleDialog.select=!0,this.vehicle=Object.assign({},e)},selectGuideHandle:function(e){this.guideDialog.show=!1,this.guideDialog.select=!0,this.guide=Object.assign({},e)},valideItinerary:function(){var e=!0,t=!1,i=void 0;try{for(var a,r=this.postForm.itinerary[Symbol.iterator]();!(e=(a=r.next()).done);e=!0){var o=a.value;if(""===o.itinerary||void 0===o.itinerary)return this.$message({message:"Itinerary information is incomplete",type:"error"}),!1}}catch(l){t=!0,i=l}finally{try{e||null==r.return||r.return()}finally{if(t)throw i}}return!0},guide_charge:function(){var e=0,t=!0,i=!1,a=void 0;try{for(var r,o=this.postForm.itinerary[Symbol.iterator]();!(t=(r=o.next()).done);t=!0){var l=r.value;e+=Number(l.guide_charge)}}catch(n){i=!0,a=n}finally{try{t||null==o.return||o.return()}finally{if(i)throw a}}return e},vehicle_charge:function(){var e=0,t=!0,i=!1,a=void 0;try{for(var r,o=this.postForm.itinerary[Symbol.iterator]();!(t=(r=o.next()).done);t=!0){var l=r.value;e+=Number(l.vehicle_gross_charge)}}catch(n){i=!0,a=n}finally{try{t||null==o.return||o.return()}finally{if(i)throw a}}return e},discount:function(){var e=0,t=this.$store.getters.user;if(t&&t.company&&t.company.discount){var i=Number(t.company.discount),a=!0,r=!1,o=void 0;try{for(var l,n=this.postForm.itinerary[Symbol.iterator]();!(a=(l=n.next()).done);a=!0){var s=l.value;e+=Math.abs(s.vehicle_gross_charge-s.vehicle_cost_charge)*i}}catch(c){r=!0,o=c}finally{try{a||null==n.return||n.return()}finally{if(r)throw o}}}return e},total:function(){return Number(this.vehicle_charge()+this.guide_charge()-this.discount())},updateItineraryData:function(){var e=this;this.itineraryDialog.data.freedom_day&&(this.itineraryDialog.data.full_day=!0,this.itineraryDialog.data.itinerary="Freedom Day",this.itineraryDialog.data.vehicle_cost_charge=0,this.itineraryDialog.data.vehicle_gross_charge=0,this.itineraryDialog.data.guide_charge=0),this.$refs["itineraryForm"].validate(function(t){if(t){var i=!0,a=!1,r=void 0;try{for(var o,l=e.postForm.itinerary[Symbol.iterator]();!(i=(o=l.next()).done);i=!0){var n=o.value;if(n.day===e.itineraryDialog.data.day){var s=e.postForm.itinerary.indexOf(n);e.postForm.itinerary.splice(s,1,e.itineraryDialog.data);break}}}catch(c){a=!0,r=c}finally{try{i||null==l.return||l.return()}finally{if(a)throw r}}e.itineraryDialog.show=!1}})},handleDuration:function(){if(this.postForm.start_time&&this.postForm.end_time){var e=this.$moment(this.postForm.start_time).format("YYYY-MM-DD"),t=this.$moment(this.postForm.end_time).format("YYYY-MM-DD"),i=this.$moment(e,"YYYY-MM-DD"),a=this.$moment(t,"YYYY-MM-DD"),r=this.$moment.duration(a.diff(i)),o=r.days()+1;if(!this.isEdit){this.postForm.itinerary=[];for(var l=0;l<o;l++){var n=this.$moment(i).add(l,"days");this.postForm.itinerary.push({day:this.$moment(n).format("YYYY-MM-DD"),itinerary:"",full_day:!0,freedom_day:!1,vehicle_cost_charge:0,vehicle_gross_charge:0,guide_charge:0,remark:""})}}}},handleItineraryChange:function(e){var t=!0,i=!1,a=void 0;try{for(var r,o=this.vehicle.model.price[Symbol.iterator]();!(t=(r=o.next()).done);t=!0){var l=r.value;if(l.itinerary===e){this.itineraryDialog.data.vehicle_cost_charge=Number(l.cost_price),this.itineraryDialog.data.vehicle_gross_charge=Number(l.gross_price),this.itineraryDialog.data.full_day=l.full_day,this.guide&&(l.full_day?this.itineraryDialog.data.guide_charge=400:this.itineraryDialog.data.guide_charge=200);break}}}catch(n){i=!0,a=n}finally{try{t||null==o.return||o.return()}finally{if(i)throw a}}},getSummaries:function(e){var t=e.columns,i=e.data,a=[];return t.forEach(function(e,t){if(0!==t){var r=i.map(function(t){return Number(t[e.property])});r.every(function(e){return isNaN(e)})?a[t]="N/A":(a[t]=r.reduce(function(e,t){var i=Number(t);return isNaN(i)?e:e+t},0),a[t]+=" AED")}else a[t]="Sum"}),a}}},_=g,y=(i("d6ee"),Object(c["a"])(_,a,r,!1,null,"35cd74a1",null));t["a"]=y.exports},"6e19":function(e,t,i){},d6ee:function(e,t,i){"use strict";var a=i("6e19"),r=i.n(a);r.a},fbb2:function(e,t,i){"use strict";i.d(t,"a",function(){return r});var a=i("b775");function r(e){return Object(a["a"])({url:"vehicle/vehicles/",method:"get",params:e})}}}]);